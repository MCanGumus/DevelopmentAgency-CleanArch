@using DA.Domain.Dtos
@using DA.Domain.Entities
@using DA.Domain.Enums
@using DA.Models

@model EmployeeCalendarModel

<script>
    @{
        var daysInMonth = DateTime.DaysInMonth(Model.Filter.Year, Model.Filter.Month);
        var firstDayOfMonth = new DateTime(Model.Filter.Year, Model.Filter.Month, 1);
        var currentDayOfWeek = (int)firstDayOfMonth.DayOfWeek;
        if (currentDayOfWeek == 0) currentDayOfWeek = 7;
        else
        {
            currentDayOfWeek -= 1;
        } // Pazar gününü haftanın son günü olarak kabul et
    }
</script>


<style>
    .card-body {
        display: flex;
        flex-direction: column;
        gap: 10px; /* Öğeler arasındaki boşluk */
    }

</style>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Pazartesi</th>
            <th>Salı</th>
            <th>Çarşamba</th>
            <th>Perşembe</th>
            <th>Cuma</th>
            <th>Cumartesi</th>
            <th>Pazar</th>
        </tr>
    </thead>
    <tbody>

        @for (int week = 1; week <= 6; week++)
        {
            <tr>
                @if (week == 1)
                {

                    @for (int i = 1; i <= currentDayOfWeek; i++)
                    {
                        <td>
                        </td>
                    }
                    @for (int k = currentDayOfWeek; k < 7; k++)
                    {
                        <td>
                            <div class="card card-dark-blue">
                                <div class="card-body">
                                    <p class="fS20 mb-2">@firstDayOfMonth.ToString("dd MMMM yyyy dddd")</p>
                                    @if (Model.Employees[firstDayOfMonth].Count != 0)
                                    {
                                        @foreach (var item in Model.Employees[firstDayOfMonth])
                                        {
                                            <div class="btn-group">
                                                @if (item.IsMission)
                                                {
                                                    <button type="button" class="btn btn-success" title="@item.Description (@item.DateOfStart - @item.DateOfEnd)">@item.Name<br />(Görevli)</button>
                                                }
                                                else
                                                {
                                                    <button type="button" class="btn btn-info" title="@item.Description (@item.DateOfStart - @item.DateOfEnd)">@item.Name<br />(İzinli)</button>
                                                }
                                            </div>
                                        }
                                    }
                                </div>
                            </div>
                        </td>
                        firstDayOfMonth = firstDayOfMonth.AddDays(1);
                    }
                }
                else
                {
                    @for (int weekDay = 1; weekDay <= 7; weekDay++)
                    {
                        <td>
                            @if (firstDayOfMonth.Month == Model.Filter.Month)
                            {
                                <div class="card card-dark-blue">
                                    <div class="card-body">
                                        <p class="fS20 mb-2">@firstDayOfMonth.ToString("dd MMMM yyyy dddd")</p>
                                        @if (Model.Employees[firstDayOfMonth].Count != 0)
                                        {
                                            @foreach (var item in Model.Employees[firstDayOfMonth])
                                            {
                                                <div class="btn-group">
                                                    @if (item.IsMission)
                                                    {
                                                        <button type="button" class="btn btn-success" title="@item.Description (@item.DateOfStart - @item.DateOfEnd)">@item.Name<br />(Görevli)</button>
                                                    }
                                                    else
                                                    {
                                                        <button type="button" class="btn btn-info" title="@item.Description (@item.DateOfStart - @item.DateOfEnd)">@item.Name<br />(İzinli)</button>
                                                    }
                                                </div>
                                            }
                                        }
                                    </div>
                                </div>
                            }
                        </td>
                        firstDayOfMonth = firstDayOfMonth.AddDays(1);
                    }
                }
            </tr>
        }
    </tbody>
</table>

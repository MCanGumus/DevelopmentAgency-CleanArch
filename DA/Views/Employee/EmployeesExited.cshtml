@using DA.Domain.Dtos
@using DA.Domain.Enums
@model List<EmployeeDto>
@{
    Layout = "_Layout";

    <script>
    


    </script>

}

@section scripts {

    <script>
        $('#ExcelExportExited').on('click', function () {
            $.ajax({
                type: "POST",
                url: "/" + "Employees/ExcelExport",
                data: { isExited: true },
                success: function (response) {
                    eval(response);
                }
            });
        });

    </script>

    
}

<div class="card">
    <div class="card-body">
        <h4 class="card-title">Çıkış Yapan Personeller</h4>
        <hr />
        <button id="ExcelExportExited" class="btn btn-success mb-4 fr">Excel Çıktısı Al</button>
        <div class="table-responsive">
            <table class="table dataTable table-striped table-hover">
                <thead>
                    <tr>
                        <th>Adı-Soyadı</th>
                        <th>T.C. Kimlik No</th>
                        <th>Telefon Numarası</th>
                        <th>Kan Grubu</th>
                        <th>Cinsiyet</th>
                        <th>İşe Başlama Tarihi</th>
                        <th>İşten Çıkış Tarihi</th>
                        <th class="text-center">İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.Count != 0)
                    {
                        @foreach (EmployeeDto item in Model.OrderBy(x => x.Name))
                        {
                            <tr id="@item.Id.ToString()">
                                <td>@item.Name @item.Surname</td>
                                <td>@item.IdentificationNumber</td>
                                <td>@item.PhoneNumber</td>
                                <td>@StrBloodGroup.StrEnumBloodGroup((EnumBloodGroup)item.BloodGroup)</td>
                                <td>@item.Gender.ToString()</td>
                                <td>@item.DateOfStart.ToString("dd.MM.yyyy")</td>
                                <td>@item.ExitedDate.Value.ToString("dd.MM.yyyy")</td>
                                <td>
                                    <a onclick="AjaxMethod('Employees/GetBackToWork', '@item.Id.ToString()', 'GetBackToWork')" href=""><i class="mdi mdi-door text-success md20"></i></a>
                                    <a onclick="AjaxMethod('Employees/OpenDetail', '@item.Id.ToString()', 'OpenDetail')" href=""><i class="mdi mdi-file text-info md20"></i></a>
                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
@Html.Partial("_DetailModal")
